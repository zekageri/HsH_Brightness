class hsBrightness extends HTMLElement{template='\n    <span class="hs-brightness-lower"></span>\n    <span class="hs-brightness-handle" draggable="true">\n        <span draggable="false" class="hs-brightness-percent-holder noselect"></span>\n    </span>';percent=50;minHandleHeight=20;handleHeight=20;fullHeight=250;maxFullHeight=300;maxPercent=100;nightModePercent=20;handleEl=null;lowerHalfEl=null;userEvents={drag:null,stop:null};connectedCallback(){this.id=this.getAttribute("id"),this.id&&""!==this.id?(this.cssRoot=document.querySelector(":root"),this.setHandleHeight(this.handleHeight),this.setFullHeight(this.fullHeight),this.addTemplate(),this.getElements(),this.getAttributes(),this.addEvents()):console.error("[HSH-Brightness] - Brightness should have an ID.")}on(e,t){this.userEvents.hasOwnProperty(e)?this.userEvents[e]=t:console.error(`[HSH-Brightness] - No such event as ${e}`)}setHandleHeight(e){this.handleHeight=e,this.handleHeight<this.minHandleHeight&&(this.handleHeight=this.minHandleHeight,console.error(`[HSH-Brightness] - Minimum handle height is ${this.minHandleHeight}px!`)),this.cssRoot.style.setProperty("--hsh-brightness-handle-height",`${this.handleHeight}px`)}setFullHeight(e){this.fullHeight=e,this.fullHeight>this.maxFullHeight&&(this.fullHeight=this.maxFullHeight,console.error(`[HSH-Brightness] - Maximum full height is ${this.maxFullHeight}px!`)),this.cssRoot.style.setProperty("--hsh-brightness-height",`${this.fullHeight}px`)}getElements(){this.handleEl=this.querySelector(".hs-brightness-handle"),this.lowerHalfEl=this.querySelector(".hs-brightness-lower"),this.percentHolderEl=this.querySelector(".hs-brightness-percent-holder")}getAttributes(){this.percent=parseInt(this.getAttribute("percent")),isNaN(this.percent)&&(this.percent=50),"true"==this.getAttribute("nightmode")&&(this.nightModePercent=parseInt(this.getAttribute("nightModePercent"))),this.setNightMode(this.getAttribute("nightmode")),this.name=this.getAttribute("name"),setTimeout((()=>{this.refreshDisplayPercent()}),100)}setNightMode(e){this.nightMode=e,"true"==this.nightMode||1==this.nightMode?(this.maxPercent=this.nightModePercent,this.nightModePercent=parseInt(this.getAttribute("nightModePercent"))):"false"!=this.nightMode&&0!=this.nightMode||(this.maxPercent=100),console.log(this.maxPercent),this.setAttribute("nightmode",this.nightMode),this.setPercent(this.maxPercent/2)}setNightModePercent(e){this.nightModePercent=e}addTemplate(){this.innerHTML=this.template}addEvents(){this.handleDrag()}handleClick(){let e=this;["mouseup","touchend"].forEach((t=>e.addEventListener(t,(function(t){let s;const h=e.getBoundingClientRect();s="mouseup"==t.type?Math.abs(t.clientY-h.bottom):Math.abs(t.touches[0].pageY-h.bottom);let i=e.getPosPercent(s);return e.setPercent(i),!1}),!1)))}handleDrag(){let e=this;["drag","touchmove"].forEach((t=>e.handleEl.addEventListener(t,(function(t){const s=t.target.parentElement.getBoundingClientRect();let h;if(h="drag"==t.type?t.clientY-s.bottom:t.touches[0].pageY-s.bottom,!(h>0))return e.updateDisplayPixel(Math.abs(h)),t.preventDefault(),!1}),!1))),["dragstart","touchstart","click"].forEach((t=>e.handleEl.addEventListener(t,(function(t){let s=e.handleEl.closest("body");if(s&&(s.style["overscroll-behavior"]="contain",s.style["touch-action"]="none"),"click"!=t.type)return e.setAttribute("touching",!0),t.dataTransfer.setDragImage(document.createElement("span"),0,0),window.getSelection().removeAllRanges(),!1}),!1))),["dragend","touchend"].forEach((t=>e.handleEl.addEventListener(t,(function(t){null!==e.userEvents.stop&&e.userEvents.stop(e.percent);let s=e.handleEl.closest("body");return s&&(s.style["touch-action"]="auto"),e.setAttribute("touching",!1),!1}),!1)))}scale(e,t,s,h,i){return(e-t)*(i-h)/(s-t)+h}getReversePercent(){return this.scale(this.percent,100,0,0,100)}getPosPixel(){let e=this.offsetHeight;return this.clamp(e/100*this.percent-this.handleHeight/2)}getPosPercent(e){let t=this.maxPercent/this.offsetHeight*e;return Math.round(t)}refreshDisplayPercent(){this.lowerHalfEl.style.height=`${this.percent}%`,this.handleEl.style.bottom=`${this.getPosPixel()}px`,this.percentHolderEl.innerText=`${this.percent}%`,this.setFullPercentStyle()}updateDisplayPixel(e){if(e<0||e>this.offsetHeight)return;let t=this.getPosPercent(e);if(t>this.maxPercent)return;this.percent=t;let s=`${this.percent}%`;this.lowerHalfEl.style.height=`${e}px`,this.handleEl.style.bottom=e-this.handleHeight/2+"px",this.percentHolderEl.innerText=s,this.setFullPercentStyle(),null!==this.userEvents.drag&&this.userEvents.drag(this.percent)}setFullPercentStyle(){this.percent>=this.maxPercent-2?this.classList.add("atFull"):this.classList.remove("atFull")}clamp(e,t,s){return e>s?s:e<t?t:e}setPercent(e){(e>this.maxPercent||e<0)&&console.error(`[HSH-Brightness] - Percent must be between 0 and ${this.maxPercent}%!`),this.percent=e,this.refreshDisplayPercent()}}customElements.define("hs-brightness",hsBrightness);